<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Christopher Chou</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

  <!-- Custom styles for this template -->
  <link href="css/clean-blog.min.css" rel="stylesheet">
    <link href="css/prism.css" rel="stylesheet">
     <style>
    .code,
        code {
            background: rgba(135, 131, 120, 0.15);
            border-radius: 3px;
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-size: 85%;
            tab-size: 2;
        }

        code {
            color: #eb5757;
        }

        .code {
            padding: 1.5em 1em;
        }

        .code > code {
            background: none;
            padding: 0;
            font-size: 100%;
            color: inherit;
        }
        .image {
        border: none;
        margin: 1.5em 0;
        padding: 0;
        border-radius: 0;
        text-align: center;
    }
         figcaption {
        opacity: 0.5;
        font-size: 85%;
        margin-top: 0.5em;
    }
        .bookmark {
            text-decoration: none;
            max-height: 8em;
            padding: 0;
            display: flex;
            width: 100%;
            align-items: stretch;
        }

        .bookmark-title {
            font-size: 0.85em;
            overflow: hidden;
            text-overflow: ellipsis;
            height: 1.75em;
            white-space: nowrap;
        }

        .bookmark-text {
            display: flex;
            flex-direction: column;
        }

        .bookmark-info {
            flex: 4 1 180px;
            padding: 12px 14px 14px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .bookmark-image {
            width: 33%;
            flex: 1 1 180px;
            display: block;
            position: relative;
            object-fit: cover;
            border-radius: 1px;
        }

        .bookmark-description {
            color: rgba(55, 53, 47, 0.6);
            font-size: 0.66em;
            overflow: hidden;
            max-height: 4.5em;
            word-break: break-word;
        }

        .bookmark-href {
            font-size: 0.75em;
            margin-top: 0.25em;
        }
        .source {
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 1.5em;
            word-break: break-all;
    }
         
        .icon {
        display: inline-block;
        max-width: 1.2em;
        max-height: 1.2em;
        text-decoration: none;
        vertical-align: text-bottom;
        margin-right: 0.5em;
    }
         .user-icon {
        width: 1.5em;
        height: 1.5em;
        border-radius: 100%;
        margin-right: 0.5rem;
    }
    </style>
</head>

<body>

  <!-- Navigation -->
   <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
    <div class="container">
      <a class="navbar-brand" href="index.html">Christopher Chou</a>
      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        Menu
        <i class="fas fa-bars"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
            <li class="nav-item">
            <a class="nav-link" href="MLhome.html">Machine Learning</a>
          </li> 
            <li class="nav-item">
            <a class="nav-link" href="datavisualizationhome.html">Data Visualization</a>
          </li> 
          <li class="nav-item">
            <a class="nav-link" href="webdevhome.html">Website Development</a>
          </li>
         <li class="nav-item">
            <a class="nav-link" href="programlanghome.html">Programming Languages</a>
          </li>   
          <li class="nav-item">
            <a class="nav-link" href="physicshome.html">Physics</a>
          </li>         
        </ul>
      </div>
    </div>
  </nav>

  <!-- Page Header -->
  <header class="masthead" style="background-image: url('img/breastCancerBack.jpg')">
    <div class="overlay"></div>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <div class="post-heading">
            <h1>Logistic Regression with Keras</h1>
            <span class="meta">Posted by
              Christopher Chou
              on April 24, 2020</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Post Content -->
  <article>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
         <article id="f42a287f-3e43-46cf-bdff-0f6e7c708dc8" class="page sans"><header><h1 class="page-title">Logistic Regression with Keras</h1></header><div class="page-body"><p id="8dc2f83b-4ad6-4f7e-8a44-9d0df48df64e" class="">In this blog, I will be going over how to implement a deep learning model for the problem of Logistic Regression using Keras.</p><p id="84674885-9ecb-444a-942b-933081cacc04" class="">I created a video on the entire coding process for this deep learning model which you can check out down below:</p><figure id="efae0456-978e-48ab-96f8-399a0a80f3ff"><div align = "center"><iframe width="560" height="315" src="https://www.youtube.com/embed/_x1itXI9Igw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><figcaption>Logistic Regression Video</figcaption></div></figure><p id="a49fca8a-0f2e-4cc5-a82d-53863c69a6e1" class="">
</p><p id="d0d65b9d-1ffe-4638-96dd-8928a6085695" class=""> <br> </p>
             <h3 id="dc4df274-03ac-4978-a096-ac22e26ec973" class="">Importing Libraries</h3><pre id="68610284-7930-4729-bc53-39569f5b4c84" class="code"><code class = "lang-python">import numpy as np
import pandas as pd
from sklearn import preprocessing
from sklearn import datasets

import tensorflow as tf
from keras.models import Model, Sequential
from keras.layers import Dense
from sklearn.model_selection import train_test_split

from sklearn.naive_bayes import GaussianNB
from sklearn.metrics import classification_report, accuracy_score</code></pre><p id="9b4b9564-e012-4a72-b8b5-32dc078d161d" class="">We import the libraries that we will need for this program. I spaced it out so it should look something like </p><ul id="3905ce37-4233-47d1-a0eb-66064e8c8c44" class="bulleted-list"><li>Datasets/Preprocessing</li></ul><ul id="29bbd320-8b2f-4c58-8970-1055116e05a7" class="bulleted-list"><li>Deep Learning</li></ul><ul id="45fdb172-51cb-4f81-b691-ca93822f0db3" class="bulleted-list"><li>Machine Learning / Metrics</li></ul><p id="22d94b8d-72c4-425f-bfb5-cf3a919b7c95" class="">
</p>
             <p id="d0d65b9d-1ffe-4638-96dd-8928a6085695" class=""> <br> </p>
             <h3 id="09e195e7-667e-46c1-96ea-b5405e556ce8" class="">Reading the Dataset</h3><pre id="c389c0b9-835b-4b86-9942-438914f9f72f" class="code"><code class = "lang-python">data = datasets.load_breast_cancer()
X = pd.DataFrame(data[&#x27;data&#x27;])
y = data[&#x27;target&#x27;]
X.columns = data.feature_names
X.head()</code></pre><p id="907e52f9-f427-4a7c-b4ed-afc026f69259" class="">I basically read in the dataset which in this case in the breast cancer dataset.</p><p id="a2bb6306-9c14-4864-a4c7-6a209c32df9b" class="">I then have to scale the data because the different numerical features were of completely different magnitudes which makes it important to normalize the data.</p><pre id="02a5bc97-a302-4718-835e-4a742cb9e756" class="code"><code class = "lang-python">Xscaled = preprocessing.scale(X)
X_train, X_test, y_train, y_test = train_test_split(Xscaled, y, test_size = 0.20, random_state =42)</code></pre><p id="5085d870-af4b-4c14-b80a-15c28ba1617c" class="">
</p>
           <p id="d0d65b9d-1ffe-4638-96dd-8928a6085695" class=""> <br> </p>
             
             
             <h3 id="54bec3df-1892-47be-9cd2-8de5650e4c91" class="">Creating the Model</h3><pre id="eadb4b46-3d39-40e0-aa0c-1c6959bd5a1c" class="code"><code class = "lang-python">model = Sequential()
model.add(Dense(128, input_dim = 30, activation = &quot;relu&quot;))
model.add(Dense(64, activation = &quot;relu&quot;))
model.add(Dense(1,  activation = &quot;sigmoid&quot;))
model.compile(optimizer = &quot;adam&quot;, loss = &quot;binary_crossentropy&quot;, metrics = [&#x27;accuracy&#x27;])</code></pre><p id="b57e6772-6e78-4b88-a4b6-ea2f0113adf1" class="">I will now break down what each of these do which should be quite easy because this is a feed-forward neural network.</p><ul id="83bf239d-bb27-4038-99d3-f549284eb92c" class="bulleted-list"><li>Sequential model is used because this is a linear format where we go from one layer to another</li></ul><ul id="b06252a9-d4ce-4d2d-b478-c981eb1da96d" class="bulleted-list"><li>Dense layers are used because they provide us with the feed-forward neural network that we want. We aren&#x27;t looking for anything complex like a convolutional neural network or anything. The input dimensions for the first layer must be given because there are 30 different features that we are training on.</li></ul><ul id="ec891e0c-379a-4daa-9b33-93c996b7144b" class="bulleted-list"><li>We compile with adam as well as binary cross entropy because the final answer is in a true/false format.</li></ul><p id="362f3b50-c825-4774-9b5e-030f814442bb" class="">
</p>
             <p id="d0d65b9d-1ffe-4638-96dd-8928a6085695" class=""> <br> </p>
             <h3 id="8f7e6655-bb67-4acd-b01d-1957f340473a" class="">Training the Model</h3><pre id="c1eef77c-cbcd-449d-b825-60b3d481fe7c" class="code"><code class = "lang-python">model.fit(X_train,y_train,epochs = 10)</code></pre><p id="9f60a41c-5eed-4f97-9a68-4f238d3389b9" class="">After training the model over 10 epochs, we get a feedback like this:</p><pre id="bff46db5-8d8c-4028-9250-4d3aad38510a" class="code"><code class = "lang-python">Epoch 1/10
455/455 [==============================] - 0s 266us/step - loss: 0.4253 - accuracy: 0.8659
Epoch 2/10
455/455 [==============================] - 0s 44us/step - loss: 0.1694 - accuracy: 0.9516
Epoch 3/10
455/455 [==============================] - 0s 40us/step - loss: 0.1108 - accuracy: 0.9670
Epoch 4/10
455/455 [==============================] - 0s 42us/step - loss: 0.0861 - accuracy: 0.9736
Epoch 5/10
455/455 [==============================] - 0s 42us/step - loss: 0.0724 - accuracy: 0.9802
Epoch 6/10
455/455 [==============================] - 0s 42us/step - loss: 0.0642 - accuracy: 0.9824
Epoch 7/10
455/455 [==============================] - 0s 44us/step - loss: 0.0556 - accuracy: 0.9824
Epoch 8/10
455/455 [==============================] - 0s 44us/step - loss: 0.0504 - accuracy: 0.9868
Epoch 9/10
455/455 [==============================] - 0s 42us/step - loss: 0.0437 - accuracy: 0.9890
Epoch 10/10
455/455 [==============================] - 0s 40us/step - loss: 0.0412 - accuracy: 0.9912</code></pre><p id="804d910e-5582-43ab-96ad-1768d814cc39" class="">We reached about 99% accuracy which is incredibly good. This was super fast because the sample size was pretty small.</p><p id="9e0aa8ba-3999-4d31-a69c-37aa82dc2dc1" class="">
</p><p id="d0d65b9d-1ffe-4638-96dd-8928a6085695" class=""> <br> </p>
             
             <h3 id="000c72f6-8a9f-4e1b-8cbb-e9b7f8ab549d" class="">Evaluating Metrics + Machine Learning</h3><p id="143e0e54-b02a-4541-b53e-d8504839bb16" class="">I will now print out the classification report of the model as well as compare our deep learning model to its machine learning counterpart.</p><pre id="a0a3a26c-30e2-4fa4-8e73-a2ba656b1009" class="code"><code class = "lang-python">Xscaledt = preprocessing.scale(X_test)
preds = model.predict(Xscaledt)
for i in range(0, len(preds)):
    if preds[i] &gt;= 0.5:
        preds[i] = 1
    else:
        preds[i] = 0
print(classification_report(y_test,preds))</code></pre><p id="8161c462-77e1-4d39-95c8-e66765ca6cc3" class="">By doing some manipulation in order to get the arrays in 1s and 0s, we can print out the classification report which looks something like this:</p><pre id="c572aa0c-77e1-4b91-acdb-86f4fc412f44" class="code"><code class = "lang-python">              precision    recall  f1-score   support

           0       1.00      0.95      0.98        43
           1       0.97      1.00      0.99        71

    accuracy                           0.98       114
   macro avg       0.99      0.98      0.98       114
weighted avg       0.98      0.98      0.98       114</code></pre><p id="01d965ee-ff10-4e18-a022-494b56719d17" class="">This is super good, nearing 100% accuracy.</p><p id="b01502d9-8400-4b39-9525-1a6da06fd246" class="">To compare this with a regular machine learning model, I will implement Naive Bayes Classification</p><pre id="ea986290-4596-4a97-8520-f66c833378e5" class="code"><code class = "lang-python">gnb = GaussianNB()
gnb.fit(X_train,y_train)
preds2 = gnb.predict(Xscaledt)
print(classification_report(y_test,preds2))</code></pre><p id="890cf194-0631-4260-bc08-52aa5676a7ce" class="">Doing so, we get an output of</p><pre id="b4e36ddd-4372-422f-950c-be592abef419" class="code"><code class = "lang-python">              precision    recall  f1-score   support

           0       0.97      0.91      0.94        43
           1       0.95      0.99      0.97        71

    accuracy                           0.96       114
   macro avg       0.96      0.95      0.95       114
weighted avg       0.96      0.96      0.96       114
</code></pre><p id="d12d2191-1be9-4c1b-8288-2ae9a30b4817" class="">As you can see, the Naive Bayes model actually does quite well too but the deep learning model still does better.</p><p id="b3e8e925-4318-46f0-987a-ea581aab191f" class="">
</p><h3 id="4184a8cd-1412-4531-b456-7e7ce6befc56" class="">Conclusion</h3><p id="14d99b90-aded-4cbe-8199-0e54f541bdef" class="">In this blog, I went over how to implement logistic regression using Keras as well as compared its effectiveness to that of Naive Bayes. By implementing a simple program, we already surpassed a machine learning which shows just how powerful deep learning can be.</p></div></article>
        </div>
      </div>
    </div>
  </article>

  <hr>

  <!-- Footer -->
 <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <ul class="list-inline text-center">
            <li class="list-inline-item">
              <a href="https://www.youtube.com/channel/UC_6tdAt0VzazX0FwMTg3qFw">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fab fa-youtube fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
            <li class="list-inline-item">
              <a href="https://www.facebook.com/groups/406915366823943">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fab fa-facebook-f fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
            <li class="list-inline-item">
              <a href="https://github.com/BabyChouSr">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          </ul>
          <p class="copyright text-muted">Christopher Chou &copy; 2020</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Custom scripts for this template -->
  <script src="js/clean-blog.min.js"></script>
    <script src = "js/prism.js"></script>

</body>

</html>
